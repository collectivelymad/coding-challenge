<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>M.A.D. Tic-Tac-Toe</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
          integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css"
          integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

    <link rel="stylesheet" href="/src/client-style.css" crossorigin="anonymous"/>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>

<div class="container title" id="welcome">
    <div class="jumbotron">
        Finding an opponent
    </div>
</div>

<div class="container">
    <div id="board">

        <h1 class="board-title">Game On!!</h1>
      <span id="board" class="row">
        <span id="c1_1" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(1,1);"/>
        </span>
        <span id="c1_2" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(1,2);"/>
        </span>
        <span id="c1_3" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(1,3);"/>
        </span>
    </div>
    <div class="row">
        <span id="c2_1" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(2,1);"/>
        </span>
        <span id="c2_2" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(2,2);"/>
        </span>
        <span id="c2_3" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(2,3);"/>
        </span>
    </div>
    <div class="row">
        <span id="c3_1" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(3,1);"/>
        </span>
        <span id="c3_2" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(3,2);"/>
        </span>
        <span id="c3_3" class="col-xs-4 col-sm-4 col-md-4 tile">
            <img class="gamepiece" src="/img/empty.png" onclick="playTurn(3,3);"/>
        </span>
    </div>
</div>


<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
        integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
        crossorigin="anonymous"></script>
<link href="" rel="stylesheet">

<!-- socket.io client -->
<script src="/socket.io/socket.io.js"></script>
<!-- my custom client script for the game -->
<script src="./src/client-app.js"></script>
<script>

    var gamePiece;
    var gameIdentifier
    var uiEnabled = false;
    var socket = io.connect('http://localhost:8080/');

    socket.on('connect', function (playerNum) {
        console.log('connection');
    });

    socket.on('gamefound', function(playerNum, gameId){

        if (playerNum == 1) {
            gamePiece = "X";
        }
        else {
            gamePiece = "O";
        }
        gameIdentifier = gameid;

    });


    socket.on('disconnect', function () {
        console.log('disconnected');
    });

    //hook buttons to emit events.
    socket.on('nextPlayer', function () {
        console.log('on to the next one');
    });


    playTurn = function (x, y) {
//        if (!uiEnabled)
//            return;
        var data = {
            action: "turn_played",
            id: socket.id,
            col: x,
            row: y
        };


        console.log('emmit next player');

        console.log(data);

        console.log(socket);

        socket.emit('playturn', data);

        updateUI(x, y);


    }


    updateUI = function(x, y)
    {
        var key = "#c" + x + "_" + y;
        var elm = $(key).find('img');
        elm.attr('src', getImageUrl(gamePiece));
    }

    lockPage = function () {
        uiEnabled = false;
    }

    unlockPage = function () {
        uiEnabled = true;
    }

    getImageUrl = function(gamepiece){
        return "/img/" + gamepiece + ".png";
    }


</script>
</body>
</html>